{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/* eslint-disable no-underscore-dangle */\n\n/* eslint-disable camelcase */\n\nconst ZapparThree = __importStar(require(\"@zappar/zappar-threejs\"));\n\nconst react_1 = __importStar(require(\"react\"));\n\nconst fiber_1 = require(\"@react-three/fiber\");\n\nconst react_merge_refs_1 = __importDefault(require(\"react-merge-refs\"));\n\nconst store_1 = __importDefault(require(\"../../store\"));\n\nconst PlacementUI_1 = __importDefault(require(\"../util/PlacementUI\"));\n\nconst {\n  InstantWorldAnchorGroup\n} = ZapparThree;\nfiber_1.extend({\n  InstantWorldAnchorGroup\n});\n/**\n * A THREE.Group which attaches content to a point on a surface in front of the user as it moves around in the camera view.\n * @see https://docs.zap.works/universal-ar/web-libraries/react-threejs/instant-world-tracking/\n */\n\nconst ZapparInstantTracker = react_1.forwardRef((props, ref) => {\n  const {\n    camera,\n    placementMode,\n    children,\n    placementCameraOffset,\n    pipeline,\n    placementUI\n  } = props;\n  const InstantTrackerGroupRef = react_1.useRef();\n  const [_placementMode, set_placementMode] = react_1.useState(placementMode);\n  react_1.useEffect(() => {\n    set_placementMode(placementMode);\n  }, [placementMode, placementUI]);\n  const [instantWorldTracker, setInstantWorldTracker] = react_1.useState();\n  react_1.useEffect(() => {\n    setInstantWorldTracker(new ZapparThree.InstantWorldTracker(pipeline));\n  }, [pipeline]);\n  const store = store_1.default.camera(state => state);\n  const zapparCamera = (camera === null || camera === void 0 ? void 0 : camera.current) ? camera.current : store.object;\n  const placementOffset = placementCameraOffset || {\n    x: 0,\n    y: 0,\n    z: -5\n  };\n  fiber_1.useFrame(() => {\n    if (_placementMode && instantWorldTracker) {\n      if (Array.isArray(placementOffset)) {\n        instantWorldTracker.setAnchorPoseFromCameraOffset(...placementOffset);\n      } else if (typeof placementOffset === \"number\") {\n        instantWorldTracker.setAnchorPoseFromCameraOffset(0, 0, placementOffset);\n      } else if (placementOffset.x) {\n        instantWorldTracker.setAnchorPoseFromCameraOffset(placementOffset.x, placementOffset.y, placementOffset.z);\n      }\n    }\n  });\n  if (!zapparCamera || !instantWorldTracker) return null;\n\n  const _placementUI = placementUI ? react_1.default.createElement(PlacementUI_1.default, {\n    placementType: placementUI,\n    onInteract: async placed => set_placementMode(placed)\n  }) : undefined; // If a user provides a placement UI type, render that component.\n\n\n  return react_1.default.createElement(react_1.default.Fragment, null, _placementUI, react_1.default.createElement(\"instantWorldAnchorGroup\", Object.assign({\n    ref: react_merge_refs_1.default([InstantTrackerGroupRef, ref]),\n    args: [zapparCamera, instantWorldTracker]\n  }, props), children));\n});\nexports.default = ZapparInstantTracker;","map":{"version":3,"sources":["/Users/hoyiki/Desktop/react-three-example-instant-tracking-cube/node_modules/@zappar/zappar-react-three-fiber/lib/Components/trackers/InstantTrackerGroup.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","prototype","hasOwnProperty","call","__importDefault","exports","ZapparThree","require","react_1","fiber_1","react_merge_refs_1","store_1","PlacementUI_1","InstantWorldAnchorGroup","extend","ZapparInstantTracker","forwardRef","props","ref","camera","placementMode","children","placementCameraOffset","pipeline","placementUI","InstantTrackerGroupRef","useRef","_placementMode","set_placementMode","useState","useEffect","instantWorldTracker","setInstantWorldTracker","InstantWorldTracker","store","default","state","zapparCamera","current","object","placementOffset","x","y","z","useFrame","Array","isArray","setAnchorPoseFromCameraOffset","_placementUI","createElement","placementType","onInteract","placed","Fragment","assign","args"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\n/* eslint-disable no-underscore-dangle */\n/* eslint-disable camelcase */\nconst ZapparThree = __importStar(require(\"@zappar/zappar-threejs\"));\nconst react_1 = __importStar(require(\"react\"));\nconst fiber_1 = require(\"@react-three/fiber\");\nconst react_merge_refs_1 = __importDefault(require(\"react-merge-refs\"));\nconst store_1 = __importDefault(require(\"../../store\"));\nconst PlacementUI_1 = __importDefault(require(\"../util/PlacementUI\"));\nconst { InstantWorldAnchorGroup } = ZapparThree;\nfiber_1.extend({ InstantWorldAnchorGroup });\n/**\n * A THREE.Group which attaches content to a point on a surface in front of the user as it moves around in the camera view.\n * @see https://docs.zap.works/universal-ar/web-libraries/react-threejs/instant-world-tracking/\n */\nconst ZapparInstantTracker = react_1.forwardRef((props, ref) => {\n    const { camera, placementMode, children, placementCameraOffset, pipeline, placementUI } = props;\n    const InstantTrackerGroupRef = react_1.useRef();\n    const [_placementMode, set_placementMode] = react_1.useState(placementMode);\n    react_1.useEffect(() => {\n        set_placementMode(placementMode);\n    }, [placementMode, placementUI]);\n    const [instantWorldTracker, setInstantWorldTracker] = react_1.useState();\n    react_1.useEffect(() => {\n        setInstantWorldTracker(new ZapparThree.InstantWorldTracker(pipeline));\n    }, [pipeline]);\n    const store = store_1.default.camera((state) => state);\n    const zapparCamera = (camera === null || camera === void 0 ? void 0 : camera.current) ? camera.current : store.object;\n    const placementOffset = placementCameraOffset || { x: 0, y: 0, z: -5 };\n    fiber_1.useFrame(() => {\n        if (_placementMode && instantWorldTracker) {\n            if (Array.isArray(placementOffset)) {\n                instantWorldTracker.setAnchorPoseFromCameraOffset(...placementOffset);\n            }\n            else if (typeof placementOffset === \"number\") {\n                instantWorldTracker.setAnchorPoseFromCameraOffset(0, 0, placementOffset);\n            }\n            else if (placementOffset.x) {\n                instantWorldTracker.setAnchorPoseFromCameraOffset(placementOffset.x, placementOffset.y, placementOffset.z);\n            }\n        }\n    });\n    if (!zapparCamera || !instantWorldTracker)\n        return null;\n    const _placementUI = placementUI ? react_1.default.createElement(PlacementUI_1.default, { placementType: placementUI, onInteract: async (placed) => set_placementMode(placed) }) : undefined;\n    // If a user provides a placement UI type, render that component.\n    return (react_1.default.createElement(react_1.default.Fragment, null,\n        _placementUI,\n        react_1.default.createElement(\"instantWorldAnchorGroup\", Object.assign({ ref: react_merge_refs_1.default([InstantTrackerGroupRef, ref]), args: [zapparCamera, instantWorldTracker] }, props), children)));\n});\nexports.default = ZapparInstantTracker;\n"]},"metadata":{},"sourceType":"script"}